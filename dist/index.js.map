{"version":3,"file":"index.js","sources":["../src/listener.ts","../src/index.ts"],"sourcesContent":["import DeepStateObserver from \".\";\n\nclass DeepStateListener {\n  state: DeepStateObserver;\n  name: string;\n  id: number;\n\n  constructor(state: DeepStateObserver, name: string) {\n    this.state = state;\n    this.id = state.lastListenerId++;\n    this.name = name;\n    this.state.addListener(this);\n  }\n\n  destroy() {\n    this.state.destroyListener(this);\n  }\n}\n\nexport default DeepStateListener;\n","import DeepStateListener from \"./listener\";\n\nexport interface ListenersById {\n  [key: number]: DeepStateListener;\n}\n\nclass DeepStateObserver {\n  lastListenerId: number;\n  private listenersById: ListenersById;\n  private listeners: DeepStateListener[];\n\n  constructor() {\n    this.lastListenerId = 0;\n    this.listenersById = {};\n    this.listeners = [];\n  }\n\n  createListener(listenerName: string) {\n    return new DeepStateListener(this, listenerName);\n  }\n\n  addListener(listener: DeepStateListener) {\n    if (!this.listenersById[listener.id]) {\n      this.listenersById[listener.id] = listener;\n      this.listeners.push(listener);\n    }\n  }\n\n  getListeners() {\n    return this.listeners;\n  }\n\n  getListenersById() {\n    return this.listenersById;\n  }\n\n  destroyListener(listener: DeepStateListener) {\n    delete this.listenersById[listener.id];\n    this.listeners = this.listeners.filter((current) => current !== listener);\n  }\n\n  destroy() {\n    this.listenersById = {};\n    this.listeners = [];\n  }\n}\n\nexport default DeepStateObserver;\nexport { DeepStateObserver, DeepStateListener };\n"],"names":[],"mappings":"AAEA,MAAA,iBAAA,CAAA;AACA;AACA;AACA;AACA;AACA,EAAA,WAAA,CAAA,KAAA,EAAA,IAAA,EAAA;AACA,IAAA,IAAA,CAAA,KAAA,GAAA,KAAA,CAAA;AACA,IAAA,IAAA,CAAA,EAAA,GAAA,KAAA,CAAA,cAAA,EAAA,CAAA;AACA,IAAA,IAAA,CAAA,IAAA,GAAA,IAAA,CAAA;AACA,IAAA,IAAA,CAAA,KAAA,CAAA,WAAA,CAAA,IAAA,CAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,OAAA,GAAA;AACA,IAAA,IAAA,CAAA,KAAA,CAAA,eAAA,CAAA,IAAA,CAAA,CAAA;AACA,GAAA;AACA;;ACXA,MAAA,iBAAA,CAAA;AACA;AACA;AACA;AACA;AACA,EAAA,WAAA,GAAA;AACA,IAAA,IAAA,CAAA,cAAA,GAAA,CAAA,CAAA;AACA,IAAA,IAAA,CAAA,aAAA,GAAA,EAAA,CAAA;AACA,IAAA,IAAA,CAAA,SAAA,GAAA,EAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,cAAA,CAAA,YAAA,EAAA;AACA,IAAA,OAAA,IAAA,iBAAA,CAAA,IAAA,EAAA,YAAA,CAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,WAAA,CAAA,QAAA,EAAA;AACA,IAAA,IAAA,CAAA,IAAA,CAAA,aAAA,CAAA,QAAA,CAAA,EAAA,CAAA,EAAA;AACA,MAAA,IAAA,CAAA,aAAA,CAAA,QAAA,CAAA,EAAA,CAAA,GAAA,QAAA,CAAA;AACA,MAAA,IAAA,CAAA,SAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA;AACA,KAAA;AACA,GAAA;AACA;AACA,EAAA,YAAA,GAAA;AACA,IAAA,OAAA,IAAA,CAAA,SAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,gBAAA,GAAA;AACA,IAAA,OAAA,IAAA,CAAA,aAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,eAAA,CAAA,QAAA,EAAA;AACA,IAAA,OAAA,IAAA,CAAA,aAAA,CAAA,QAAA,CAAA,EAAA,CAAA,CAAA;AACA,IAAA,IAAA,CAAA,SAAA,GAAA,IAAA,CAAA,SAAA,CAAA,MAAA,CAAA,CAAA,OAAA,KAAA,OAAA,KAAA,QAAA,CAAA,CAAA;AACA,GAAA;AACA;AACA,EAAA,OAAA,GAAA;AACA,IAAA,IAAA,CAAA,aAAA,GAAA,EAAA,CAAA;AACA,IAAA,IAAA,CAAA,SAAA,GAAA,EAAA,CAAA;AACA,GAAA;AACA;;;;"}